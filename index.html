<!doctype html>
<html lang="pt-BR">
<head>
<meta charset="utf-8">
<title>Mapeamento Cultural â€“ Instituto SumaÃºma</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css"/>

<style>
/* ===== RESET ===== */
html, body {
  margin: 0;
  height: 100%;
  font-family: Arial, sans-serif;
}

/* ===== HEADER ===== */
header {
  height: 80px;
  background: #0f3d2e;
  display: flex;
  align-items: center;
  padding: 0 20px;
  color: #fff;
}

header img {
  height: 45px;
  margin-right: 15px;
}

header h1 {
  font-size: 20px;
  margin: 0;
}

/* ===== LAYOUT ===== */
#layout {
  display: flex;
  height: calc(100% - 80px);
}

/* ===== SIDEBAR ===== */
#sidebar {
  width: 420px;
  min-width: 420px;
  max-width: 420px;
  background: #fff;
  border-right: 1px solid #ddd;
  overflow-y: auto;
}

.sidebar-inner {
  padding: 20px;
}

#sidebar input {
  width: 100%;
  padding: 10px;
  margin-bottom: 15px;
}

/* ===== RESULTADOS (CSV) ===== */
#results .item {
  border: 1px solid #ddd;
  padding: 10px;
  margin-bottom: 10px;
  cursor: pointer;
}

#results .item:hover {
  background: #f5f5f5;
}

/* ===== MAP + DETAILS ===== */
#content {
  flex: 1;
  position: relative;
}

#map {
  width: 100%;
  height: 100%;
}

/* ===== DETAILS PANEL ===== */
#details-panel {
  display: none;
  position: absolute;
  top: 0;
  right: 0;
  width: 420px;
  height: 100%;
  background: #fff;
  border-left: 1px solid #ddd;
  padding: 20px;
  overflow-y: auto;
  z-index: 1000;
}

#details-panel h2 {
  margin-top: 0;
}

/* ===== BUTTONS ===== */
.btn {
  display: inline-block;
  padding: 10px 14px;
  margin-right: 10px;
  margin-top: 10px;
  text-decoration: none;
  color: #fff;
  border-radius: 4px;
  cursor: pointer;
}

.btn-contact {
  background: #25D366;
}

.btn-map {
  background: #0f3d2e;
}

/* ===== STATES ===== */
.show-details #details-panel {
  display: block;
}

.full-map #sidebar,
.full-map #details-panel {
  display: none;
}

/* ===== RESPONSIVE ===== */
@media (max-width: 900px) {
  #sidebar {
    width: 100%;
    max-width: none;
  }
}
</style>
</head>

<body>

<!-- ===== HEADER ===== -->
<header>
  <img src="assets/logo-sumauma.png" alt="Instituto SumaÃºma">
  <h1>Mapeamento Cultural</h1>
</header>

<!-- ===== MAIN LAYOUT ===== -->
<div id="layout">

  <!-- SIDEBAR -->
  <aside id="sidebar">
    <div class="sidebar-inner">

      <!-- ðŸ”¹ aqui entram filtros, abas, selects etc -->
      <input type="text" id="search" placeholder="Pesquisar iniciativas culturais...">

      <!-- ðŸ”¹ resultados vindos do CSV -->
      <div id="results"></div>

    </div>
  </aside>

  <!-- CONTENT -->
  <section id="content">

    <!-- MAP -->
    <div id="map"></div>

    <!-- DETAILS -->
    <div id="details-panel"></div>

  </section>

</div>

<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>

<script>
/* ===== MAP INIT ===== */
const map = L.map('map').setView([-14.235, -51.9253], 4);

L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',{
  attribution: 'Â© OpenStreetMap'
}).addTo(map);

/* ===== EXEMPLO (SUBSTITUA PELO CSV) ===== */
const dados = [
  {
    nome: "Rede Kalunga ComunicaÃ§Ãµes",
    cidade: "Cavalcante",
    estado: "GO",
    categoria: "ComunicaÃ§Ã£o ComunitÃ¡ria",
    descricao: "Projeto de comunicaÃ§Ã£o popular voltado Ã  cultura Kalunga.",
    contato: "https://www.instagram.com/",
    lat: -13.7975,
    lng: -47.4581
  }
];

const markers = [];

/* ===== RENDER RESULTADOS ===== */
const resultsEl = document.getElementById("results");

dados.forEach(item => {

  // marcador
  const marker = L.marker([item.lat, item.lng]).addTo(map);
  marker.bindPopup(`
    <strong>${item.nome}</strong><br>
    ${item.cidade} - ${item.estado}<br>
    ${item.categoria}<br><br>
    ${item.descricao}<br><br>
    <a href="${item.contato}" target="_blank">Entrar em contato</a>
  `);
  markers.push({ marker, item });

  // item lista
  const div = document.createElement("div");
  div.className = "item";
  div.innerHTML = `
    <strong>${item.nome}</strong><br>
    ${item.cidade} - ${item.estado}<br>
    ${item.categoria}
  `;

  div.onclick = () => abrirDetalhes(item);
  resultsEl.appendChild(div);
});

/* ===== DETAILS ===== */
function abrirDetalhes(item){
  document.body.classList.add("show-details");
  document.body.classList.remove("full-map");

  document.getElementById("details-panel").innerHTML = `
    <h2>${item.nome}</h2>
    <p><strong>Cidade:</strong> ${item.cidade} - ${item.estado}</p>
    <p><strong>Categoria:</strong> ${item.categoria}</p>
    <p>${item.descricao}</p>

    <a class="btn btn-contact" href="${item.contato}" target="_blank">
      Entrar em contato
    </a>

    <button class="btn btn-map" onclick="verNoMapa(${item.lat}, ${item.lng})">
      Ver no mapa
    </button>
  `;
}

/* ===== VIEW MAP ===== */
function verNoMapa(lat, lng){
  document.body.classList.remove("show-details");
  document.body.classList.add("full-map");

  map.invalidateSize();
  map.setView([lat, lng], 15);

  markers.forEach(m => {
    if (m.item.lat === lat) {
      m.marker.openPopup();
    }
  });
}
</script>

</body>
</html>
